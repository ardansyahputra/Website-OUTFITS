<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OUTFITS | Inventory</title>

<!-- Bootstrap & Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root {
  --sidebar: #0e1720;
  --accent: #0b66ff;
  --bg: #f4f7fb;
}
body {
  min-height: 100vh;
  font-family: "Inter", system-ui, sans-serif;
  background: var(--bg);
  margin: 0;
  display: flex;
}

/* Sidebar */
.sidebar {
  width: 240px;
  background: var(--sidebar);
  color: #ccd6dd;
  padding: 18px;
  position: fixed;
  height: 100%;
  overflow-y: auto;
}
.sidebar .logo {
  font-weight: 800;
  color: #d8c69a;
  font-size: 20px;
  margin-bottom: 18px;
}
.sidebar a {
  color: #bfcbd2;
  text-decoration: none;
  display: block;
  padding: 10px;
  border-radius: 8px;
}
.sidebar a.active,
.sidebar a:hover {
  background: rgba(255, 255, 255, 0.05);
  color: white;
}

/* Main */
.main {
  margin-left: 260px;
  flex: 1;
  padding: 28px;
}
.card {
  border: none;
  border-radius: 10px;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.05);
}

/* Table */
.table img {
  width: 60px;
  height: 60px;
  object-fit: cover;
  border-radius: 8px;
}
.action-btns button {
  border: none;
  background: none;
  color: var(--accent);
  cursor: pointer;
  padding: 4px;
  transition: 0.2s;
}
.action-btns .delete {
  color: #dc3545;
}
.action-btns button:hover {
  transform: scale(1.15);
  opacity: 0.8;
}

/* ðŸ”¹ RESPONSIVE DESIGN */
@media (max-width: 992px) {
  body {
    flex-direction: column;
  }

  .sidebar {
    position: relative;
    width: 100%;
    height: auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 18px;
  }

  .sidebar nav {
    display: flex;
    gap: 10px;
  }

  .sidebar a {
    padding: 8px 10px;
    font-size: 14px;
  }

  .main {
    margin-left: 0;
    padding: 18px;
  }

  .card {
    padding: 16px;
  }

  .table th, .table td {
    font-size: 14px;
    white-space: nowrap;
  }

  .table img {
    width: 50px;
    height: 50px;
  }
}

@media (max-width: 768px) {
  .sidebar nav {
    flex-wrap: wrap;
    gap: 8px;
  }

  .sidebar .logo {
    font-size: 18px;
  }

  h4 {
    font-size: 1.2rem;
  }

  .card h5 {
    font-size: 1rem;
  }

  .table {
    display: block;
    overflow-x: auto;
    white-space: nowrap;
  }

  #preview {
    width: 60px;
    height: 60px;
  }
}

@media (max-width: 576px) {
  .main {
    padding: 14px;
  }

  .sidebar {
    flex-direction: column;
    align-items: flex-start;
  }

  .sidebar nav {
    flex-direction: column;
    align-items: flex-start;
  }

  .row.g-3 > div {
    flex: 1 1 100%;
  }

  button, .btn {
    font-size: 14px;
  }
}
</style>
</head>
<body>
  <aside class="sidebar">
    <div class="logo">OUTFITS</div>
    <nav>
      <a href="dashboard.html"><i class="fa fa-home me-2"></i> Dashboard</a>
      <a href="inventory.html" class="active"><i class="fa fa-boxes me-2"></i> Inventori</a>
      <a href="#" id="logout"><i class="fa fa-sign-out-alt me-2"></i> Logout</a>
    </nav>
  </aside>

  <main class="main">
    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
      <h4 class="fw-bold">Inventori Produk</h4>
    </div>

    <!-- Form Tambah/Edit -->
    <div class="card p-3 mb-4">
      <h5 id="formTitle">Tambah Produk Baru</h5>
      <form id="productForm">
        <input type="hidden" id="editId">
        <div class="row g-3">
          <div class="col-md-4 col-12">
            <label class="form-label">Nama Produk</label>
            <input type="text" id="name" class="form-control" required>
          </div>
          <div class="col-md-3 col-12">
            <label class="form-label">Kategori</label>
            <input type="text" id="category" class="form-control" required>
          </div>
          <div class="col-md-2 col-12">
            <label class="form-label">Harga</label>
            <input type="number" id="price" class="form-control" required>
          </div>
          <div class="col-md-3 col-12">
            <label class="form-label">Gambar Produk</label>
            <input type="file" id="image" class="form-control" accept="image/*" required>
            <small class="text-muted">Pilih gambar produk (JPG/PNG)</small>
            <img id="preview" src="" alt="Preview" style="display:none;width:80px;height:80px;object-fit:cover;margin-top:8px;border-radius:8px;">
          </div>
          <div class="col-12">
            <label class="form-label">Deskripsi</label>
            <textarea id="desc" class="form-control" rows="2" required></textarea>
          </div>
        </div>
        <button type="submit" class="btn btn-primary mt-3"><i class="fa fa-save"></i> Simpan Produk</button>
        <button type="button" id="cancelEdit" class="btn btn-secondary mt-3" style="display:none;"><i class="fa fa-times"></i> Batal</button>
      </form>
    </div>

    <!-- Table Produk -->
    <div class="card p-3">
      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>Gambar</th>
              <th>Nama Produk</th>
              <th>Kategori</th>
              <th>Harga</th>
              <th>Deskripsi</th>
              <th style="width:110px;">Aksi</th>
            </tr>
          </thead>
          <tbody id="productTableBody"></tbody>
        </table>
      </div>
    </div>
  </main>

  <!-- Modal Konfirmasi Hapus -->
  <div class="modal fade" id="deleteModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow-sm">
        <div class="modal-header bg-danger text-white">
          <h5 class="modal-title"><i class="fa fa-trash"></i> Konfirmasi Hapus</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          Apakah kamu yakin ingin menghapus produk ini?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
          <button type="button" id="confirmDeleteBtn" class="btn btn-danger">Hapus</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Berhasil Hapus -->
  <div class="modal fade" id="successModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow-sm text-center p-4">
        <i class="fa fa-check-circle fa-3x text-success mb-3"></i>
        <h5>Hapus berhasil!</h5>
      </div>
    </div>
  </div>

  <!-- Modal Berhasil Simpan -->
  <div class="modal fade" id="saveModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow-sm text-center p-4">
        <i class="fa fa-check-circle fa-3x text-primary mb-3"></i>
        <h5>Produk berhasil disimpan!</h5>
      </div>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
const STORAGE_KEY = 'siam_products';
let products = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
let imageBase64 = '';
let productToDelete = null;

const deleteModal = new bootstrap.Modal(document.getElementById('deleteModal'));
const successModal = new bootstrap.Modal(document.getElementById('successModal'));
const saveModal = new bootstrap.Modal(document.getElementById('saveModal'));

// ðŸ”¹ Render tabel
function renderTable() {
  const tbody = document.getElementById('productTableBody');
  tbody.innerHTML = '';
  if (products.length === 0) {
    tbody.innerHTML = `<tr><td colspan="7" class="text-center text-muted">Belum ada produk</td></tr>`;
    return;
  }
  products.forEach((p, i) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${i + 1}</td>
      <td><img src="${p.image}" alt="${p.name}"></td>
      <td>${p.name}</td>
      <td>${p.category}</td>
      <td>Rp ${p.price.toLocaleString()}</td>
      <td>${p.desc}</td>
      <td class="action-btns text-center">
        <button onclick="editProduct('${p.id}')" title="Edit"><i class="fa fa-edit"></i></button>
        <button class="delete" onclick="deleteProduct('${p.id}')" title="Hapus"><i class="fa fa-trash"></i></button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

// ðŸ”¹ Tambah / Edit produk
document.getElementById('productForm').addEventListener('submit', e => {
  e.preventDefault();
  const id = document.getElementById('editId').value || 'p' + Date.now();
  const data = {
    id,
    name: document.getElementById('name').value.trim(),
    category: document.getElementById('category').value.trim(),
    price: parseInt(document.getElementById('price').value),
    image: imageBase64 || '',
    desc: document.getElementById('desc').value.trim()
  };

  const idx = products.findIndex(p => p.id === id);
  if (idx >= 0) products[idx] = data;
  else products.push(data);

  localStorage.setItem(STORAGE_KEY, JSON.stringify(products));
  resetForm();
  renderTable();
  saveModal.show();
  setTimeout(() => saveModal.hide(), 1500);
});

// ðŸ”¹ Edit produk
function editProduct(id) {
  const p = products.find(x => x.id === id);
  if (!p) return;
  document.getElementById('formTitle').innerText = 'Edit Produk';
  document.getElementById('editId').value = p.id;
  document.getElementById('name').value = p.name;
  document.getElementById('category').value = p.category;
  document.getElementById('price').value = p.price;
  document.getElementById('desc').value = p.desc;

  const preview = document.getElementById('preview');
  preview.src = p.image;
  preview.style.display = 'block';
  imageBase64 = p.image;

  document.getElementById('cancelEdit').style.display = 'inline-block';
}

// ðŸ”¹ Hapus produk (pakai modal)
function deleteProduct(id) {
  productToDelete = id;
  deleteModal.show();
}

document.getElementById('confirmDeleteBtn').addEventListener('click', () => {
  if (!productToDelete) return;
  products = products.filter(p => p.id !== productToDelete);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(products));
  renderTable();
  deleteModal.hide();
  successModal.show();
  setTimeout(() => successModal.hide(), 1500);
});

// ðŸ”¹ Reset form
document.getElementById('cancelEdit').addEventListener('click', resetForm);
function resetForm() {
  document.getElementById('productForm').reset();
  document.getElementById('editId').value = '';
  document.getElementById('formTitle').innerText = 'Tambah Produk Baru';
  document.getElementById('cancelEdit').style.display = 'none';
  document.getElementById('preview').style.display = 'none';
  imageBase64 = '';
}

// ðŸ”¹ Image Preview
const imageInput = document.getElementById('image');
const preview = document.getElementById('preview');
imageInput.addEventListener('change', function() {
  const file = this.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(e) {
    imageBase64 = e.target.result;
    preview.src = imageBase64;
    preview.style.display = 'block';
  };
  reader.readAsDataURL(file);
});

// ðŸ”¹ Render awal
renderTable();
</script>
</body>
</html>
