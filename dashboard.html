<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard</title>

  <!-- Bootstrap, Chart.js, FontAwesome -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://kit.fontawesome.com/1b9b7b9d6f.js" crossorigin="anonymous"></script>

  <style>
    :root{--sidebar:#0e1720;--accent:#0b66ff;--card:#fff}
    body{min-height:100vh;font-family:Inter,system-ui;background:#f4f7fb}
    .app{display:flex;min-height:100vh}
    .sidebar{width:240px;background:var(--sidebar);color:#ccd6dd;padding:18px;position:fixed;height:100%;overflow:auto}
    .sidebar .logo{font-weight:800;color:#d8c69a;font-size:20px;margin-bottom:18px}
    .sidebar a{color:#bfcbd2;text-decoration:none;display:block;padding:10px;border-radius:8px}
    .sidebar a.active, .sidebar a:hover{background:rgba(255,255,255,0.03);color:white}
    .main{margin-left:260px;flex:1;padding:28px}
    .topbar{display:flex;align-items:center;gap:12px;justify-content:flex-end}
    .card-stat{background:white;border-radius:10px;padding:20px;box-shadow:0 10px 30px rgba(2,6,23,0.06)}
    .chart-card{background:white;padding:18px;border-radius:10px;box-shadow:0 10px 30px rgba(2,6,23,0.06)}
    @media (max-width:900px){ .sidebar{position:relative;width:100%;height:auto} .main{margin-left:0;padding:18px} }
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="logo">OUTFITS <small style="display:block;font-size:12px;color:#9aa7b2"></small></div>

      <nav>
        <a href="dashboard.html" class="active"><i class="fa fa-home me-2"></i> Dashboard</a>
        <a href="#" id="goInventory"><i class="fa fa-boxes me-2"></i> Inventori</a>
        <a href="#" id="logout"><i class="fa fa-sign-out-alt me-2"></i> Logout</a>
      </nav>
    </aside>

    <main class="main">
      <div class="d-flex align-items-center justify-content-between mb-3">
        <div>
          <h4 style="margin:0">Dashboard</h4>
        </div>
        <div class="topbar">
          <select id="yearSel" class="form-select form-select-sm" style="width:120px">
            <option>2025</option><option>2024</option><option>2023</option>
          </select>
        </div>
      </div>

      <!-- stats -->
      <div class="row g-3 mb-4">
        <div class="col-md-4"><div class="card-stat"><div class="d-flex align-items-center justify-content-between"><div><h5 id="totalSales">Rp 0</h5><small class="text-muted">Total Sales</small></div><i class="fa fa-dollar-sign fa-2x text-muted"></i></div></div></div>
        <div class="col-md-4"><div class="card-stat"><div class="d-flex align-items-center justify-content-between"><div><h5 id="totalReservations">0</h5><small class="text-muted">Total Reservations</small></div><i class="fa fa-calendar-check fa-2x text-muted"></i></div></div></div>
        <div class="col-md-4"><div class="card-stat"><div class="d-flex align-items-center justify-content-between"><div><h5 id="totalCustomers">0</h5><small class="text-muted">Total Customers</small></div><i class="fa fa-users fa-2x text-muted"></i></div></div></div>
      </div>

      <!-- chart -->
      <div class="chart-card mb-4">
        <h6 style="margin-bottom:8px">Customer Over Time</h6>
        <canvas id="cusChart" height="120"></canvas>
      </div>

      <!-- product preview -->
      <div class="card-stat">
        <div class="d-flex align-items-center justify-content-between mb-2">
          <h6 style="margin:0">Product Preview</h6>
          <a href="#" id="openInventory" class="btn btn-sm btn-outline-primary">Open Inventori</a>
        </div>

        <div id="prodPreview" style="display:flex;gap:12px;flex-wrap:wrap"></div>
      </div>
    </main>
  </div>

<script>
  // auth guard
  if (!localStorage.getItem('siam_auth')) {
    location.href = 'admin.html';
  }

  // inventory link handler (ðŸ’¡ ini bagian penting yang baru)
  document.getElementById('goInventory').addEventListener('click', function(e){
    e.preventDefault();
    location.href = 'inventory.html';
  });
  document.getElementById('openInventory').addEventListener('click', function(e){
    e.preventDefault();
    location.href = 'inventory.html';
  });

  // sample data persistence
  const STORAGE_KEY = 'siam_products';
  function ensureSampleProducts(){
    const raw = localStorage.getItem(STORAGE_KEY);
    if (raw) return JSON.parse(raw);
    const sample = [
      {id:'p1',name:'Pad Thai',category:'makanan',price:70000,desc:'Stir-fried rice noodles with shrimp or chicken',image:'https://images.unsplash.com/photo-1604908176837-4e8e13d3d9a1?q=80&w=600&auto=format&fit=crop'},
      {id:'p2',name:'Som Tam',category:'makanan',price:70000,desc:'Spicy green papaya salad',image:'https://images.unsplash.com/photo-1551218808-94e220e084d2?q=80&w=600&auto=format&fit=crop'},
      {id:'p3',name:'Gaeng Som',category:'makanan',price:80000,desc:'Tangy sour curry with fish or shrimp',image:'https://images.unsplash.com/photo-1543352634-06df0d0f5f4f?q=80&w=600&auto=format&fit=crop'}
    ];
    localStorage.setItem(STORAGE_KEY, JSON.stringify(sample));
    return sample;
  }

  const products = ensureSampleProducts();

  // compute stats
  function computeStats(){
    let totalSales = 0;
    let totalReservations = Math.floor(Math.random()*5);
    let totalCustomers = Math.floor(Math.random()*20);
    products.forEach(p => totalSales += p.price * (Math.floor(Math.random()*4)));
    document.getElementById('totalSales').innerText = new Intl.NumberFormat('id-ID',{style:'currency',currency:'IDR'}).format(totalSales);
    document.getElementById('totalReservations').innerText = totalReservations;
    document.getElementById('totalCustomers').innerText = totalCustomers;
  }
  computeStats();

  // chart sample
  const ctx = document.getElementById('cusChart').getContext('2d');
  const labels = ['Jan','Feb','Mar','Apr','Mei','Jun','Jul','Agu','Sep','Okt','Nov','Des'];
  new Chart(ctx, {
    type: 'line',
    data: {
      labels,
      datasets: [{
        label: 'Number of Guests',
        data: labels.map(()=> Math.floor(Math.random()*6)+1),
        fill: true,
        tension: 0.4,
        backgroundColor: 'rgba(6,182,212,0.12)',
        borderColor: 'rgba(6,182,212,0.9)',
        pointRadius:4
      }]
    },
    options: {
      responsive:true,
      plugins:{legend:{display:true,position:'top'}},
      scales:{y:{beginAtZero:true}}
    }
  });

  // product preview
  function renderPreview(){
    const el = document.getElementById('prodPreview');
    el.innerHTML = '';
    products.slice(0,6).forEach(p=>{
      const item = document.createElement('div');
      item.style.width='160px';
      item.style.background='white';
      item.style.borderRadius='8px';
      item.style.padding='10px';
      item.style.boxShadow='0 8px 20px rgba(2,6,23,0.06)';
      item.innerHTML = `
        <img src="${p.image}" style="width:100%;height:90px;object-fit:cover;border-radius:6px"/>
        <div style="font-weight:700;margin-top:8px">${p.name}</div>
        <small style="color:#6b7280">Rp ${p.price.toLocaleString()}</small>`;
      el.appendChild(item);
    });
  }
  renderPreview();

  // logout
  document.getElementById('logout').addEventListener('click', function(e){
    e.preventDefault();
    localStorage.removeItem('siam_auth');
    location.href = 'admin.html';
  });
</script>
</body>
</html>
